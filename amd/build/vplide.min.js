function _typeof(e){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){_typeof=function(e){return typeof e}}else{_typeof=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e}}return _typeof(e)}define ("mod_vpl/vplide",["jquery","jqueryui","mod_vpl/vplutil","mod_vpl/vplidefile","mod_vpl/vplidebutton","mod_vpl/vplterminal","mod_vpl/vplvnc"],function(t,e,l,n,a,o,d){var s,r=function(e,c){var C=this,V,k,S,I,N,H=c.minfiles||0,W=c.maxfiles||0,P=c.restrictededitor||c.example,O=c.example,R=!1,E=l.scrollBarWidth(),D=l.str,j=t("#"+e);t("head").append("<meta name=\"viewport\" content=\"initial-scale=1\">").append("<meta name=\"viewport\" width=\"device-width\">").append("<link rel=\"stylesheet\" href=\"../editor/VPLIDE.css\"/>");if("object"!=_typeof(j)){throw new Error("VPL: constructor tag_id not found")}var B={new:!0,rename:!0,delete:!0,save:!0,run:!0,edit:!0,debug:!0,evaluate:!0,import:!0,resetfiles:!0,sort:!0,multidelete:!0,acetheme:!0,console:!0,comments:!0};if("undefined"==typeof c.loadajaxurl){c.loadajaxurl=c.ajaxurl}(function(){var e=H<W;c.new=e;c.rename=e;c.delete=e;c.comments=c.comments&&!c.example;c.acetheme=!0})();c.sort=2<=W-H;c.multidelete=c.sort;c.import=!P;var q=function(e){if(!B[e]){return!0}return c[e]};c.console=q("run")||q("debug");if("undefined"==typeof c.fontSize){c.fontSize=12}c.fontSize=parseInt(c.fontSize);function p(i){if(P){i.originalEvent.dataTransfer.dropEffect="none"}else{i.originalEvent.dataTransfer.dropEffect="copy"}i.preventDefault()}function u(i){if(P){i.stopImmediatePropagation();return!1}var e=i.originalEvent.dataTransfer;if(0<e.files.length){l.readSelectedFiles(e.files,function(e){return V.addFile(e,!0,N,I)},function(){V.fileListVisibleIfNeeded()});i.stopImmediatePropagation();return!1}return!1}j.on("drop",u);j.on("dragover",p);function g(i){if(P){i.stopPropagation();return!1}return!0}var K=t("#vpl_menu"),U=new a(K,q),G=t("#vpl_tr"),r=t("#vpl_filelist"),X=t("#vpl_filelist_header"),Y=t("#vpl_filelist_content"),Q=t("#vpl_tabs_ul"),J=t("#vpl_tabs"),Z=t("#vpl_results"),$=t("#vpl_results_accordion");r.vplMinWidth=80;Z.vplMinWidth=100;function m(e,i){if("newHeader"in i){if(i.newHeader.hasClass("vpl_ide_accordion_t_grade")){return!1}}return!0}function h(){var a=t("#vpl_tabs_ul");t("#vpl_tabs").tabs();var o=t("#vpl_tabs").tabs("widget"),d=[],m=[],h=!0,f=this;(function(){var e;f.setVersion=function(i){e=i};f.getVersion=function(){return e}})();this.updateFileList=function(){f.generateFileList()};this.fileNameExists=function(e){for(var t=e.toLowerCase(),l=0;l<d.length;l++){if(d[l].getFileName().toLowerCase()==t){return l}}return-1};function e(e){for(var t=e.toLowerCase()+"/",l=0,n;l<d.length;l++){n=d[l].getFileName().toLowerCase()+"/";if(0===n.indexOf(t)||0===t.indexOf(n)){return!0}}return!1}function i(e,t){if(l.isBlockly(e)){return!1}if(l.isBlockly(t)){for(var n=0;n<d.length;n++){if(l.isBlockly(d[n].getFileName())){return!0}}}return!1}this.restrictedPaste=g;this.dropHandler=u;this.dragoverHandler=p;this.readOnly=O;this.restrictedEdit=P;this.adjustTabsTitles=k;this.minNumberOfFiles=H;this.scrollBarWidth=E;var v="";this.setClipboard=function(e){v=e};this.getClipboard=function(){return v};this.getTabPos=function(e){for(var t=0;t<m.length;t++){if(m[t]==e){return t}}return m.length};this.getTheme=function(){return c.theme};this.setTheme=function(e){c.theme=e;for(var t=0;t<d.length;t++){d[t].setTheme(e)}};this.addTab=function(e){a.append("<li id=\"vpl_tab_name"+e+"\">"+("<a href=\"#vpl_file"+e+"\"></a>")+"</li>");o.append("<div id=\"vpl_file"+e+"\" class=\"vpl_ide_file\"></div>")};this.removeTab=function(e){a.find("#vpl_tab_name"+e).remove();o.find("#vpl_file"+e).remove()};this.open=function(e){var i;if("object"==_typeof(e)){i=e}else{i=d[e]}if(i.isOpen()){return}var t=i.getId();f.addTab(t);m.push(i);U.setGetkeys(i.open());o.tabs("refresh");k(!1);l.delay("updateFileList",f.updateFileList);l.delay("updateMenu",N)};this.close=function(e){if(!e.isOpen()){return}var i,t=e.getId();e.close();f.removeTab(t);var n=f.getTabPos(e);m.splice(n,1);o.tabs("refresh");k(!1);f.fileListVisible(!0);l.delay("updateFileList",f.updateFileList);l.delay("adjustTabsTitles",k,!1);if(m.length>n){i=f.getFilePosById(m[n].getId());f.gotoFile(i,"c");return}if(0<n){i=f.getFilePosById(m[n-1].getId());f.gotoFile(i,"c")}};this.isClosed=function(e){return!d[e].isOpen()};this.fileListVisible=function(e){if(e===r.vplVisible){return}if(e){l.delay("fileListVisible",function(){r.vplVisible=!0;f.updateFileList();r.show();S()})}else{l.delay("fileListVisible",function(){r.vplVisible=!1;r.hide();S()})}};this.isFileListVisible=function(){return r.vplVisible};this.fileListVisibleIfNeeded=function(){if(this.isFileListVisible()){return}for(var e=0;e<d.length;e++){if(!d[e].isOpen()){this.fileListVisible(!0);return}}};this.setFontSize=function(e){c.fontSize=e;for(var t=0;t<d.length;t++){d[t].setFontSize(e)}Fe.setFontSize(e)};this.getFontSize=function(){return c.fontSize};this.addFile=function(t,a,o,r){if("string"!=typeof t.name||!l.validPath(t.name)){r(D("incorrect_file_name")+" ("+t.name+")");return!1}if(!0!==a){a=!1}var c=this.fileNameExists(t.name);if(-1!=c){if(a){d[c].setContent(t.contents);f.setModified();o();l.delay("updateFileList",f.updateFileList);return t}else{r(D("filenotadded",t.name));return!1}}if(e(t.name)||i("",t.name)){r(D("filenotadded",t.name));return!1}if(d.length>=W){r(D("maxfilesexceeded")+" ("+W+")");return!1}var p=l.getUniqueId(),u=new n(p,t.name,t.contents,this,s);if(1==t.encoding){u.extendToBinary()}else{if(l.isBlockly(t.name)){u.extendToBlockly()}else{u.extendToCodeEditor()}}u.setFileName(t.name);d.push(u);f.setModified();if(5<d.length){f.fileListVisible(!0)}o();return u};this.renameFile=function(t,n,a){var o=this.fileNameExists(t);try{if(-1==o){throw new Error("Internal error: File name not found")}if(o<H){throw new Error("Internal error: Renaming requested filename")}if(d[o].getFileName()==n){return!0}if(!l.validPath(n)||e(n)||i(t,n)){throw D("incorrect_file_name")}if(l.isBinary(t)&&l.fileExtension(t)!=l.fileExtension(n)){throw D("incorrect_file_name")}if(l.isBlockly(t)!=l.isBlockly(n)){throw D("incorrect_file_name")}d[o].setFileName(n)}catch(i){a(D("filenotrenamed",n)+": "+i);return!1}f.setModified();k(!1);l.delay("updateFileList",f.updateFileList);return!0};this.deleteFile=function(e,i,t){var n=this.fileNameExists(e);if(-1==n){t(D("filenotdeleted",e));return!1}if(n<H){t(D("filenotdeleted",e));return!1}f.setModified();f.close(d[n]);d.splice(n,1);l.delay("updateFileList",f.updateFileList);return!0};this.currentFile=function(){var e=o.tabs("option","active");if(e in m){var i=m[e];if(0===arguments.length){return i}var t=arguments[0];if("function"==typeof i[t]){var l=i[t],n=Array.prototype.slice(arguments);n.shift();return l.apply(i,n)}}return!1};this.currentPos=function(){return o.tabs("option","active")};this.getFileTab=function(e){for(var t=0;t<m.length;t++){if(m[t].getId()==e){return t}}return-1};this.getFilePosById=function(e){for(var t=0;t<d.length;t++){if(d[t].getId()==e){return t}}return-1};this.gotoFile=function(e,i){var t=d[e];f.open(t);o.tabs("option","active",f.getFileTab(t.getId()));if("c"!==i){t.gotoLine(parseInt(i,10))}t.focus()};this.gotoFileLink=function(e){var i=t(e),l=i.data("file"),n=-1;if(""<l){n=this.fileNameExists(l)}else{n=f.getFilePosById(i.data("fileid"))}if(0<=n){var a=i.data("line");if("undefined"==typeof a){a="c"}f.gotoFile(n,a);return!0}return!1};this.getFilesToSave=function(){for(var e=[],t=0,l;t<d.length;t++){l={};l.name=d[t].getFileName();l.contents=d[t].getContent();l.encoding=d[t].isBinary()?1:0;e.push(l)}return e};this.resetModified=function(){h=!1;for(var e=0;e<d.length;e++){d[e].resetModified()}l.delay("updateMenu",N);l.delay("updateFileList",f.updateFileList)};this.setModified=function(){h=!0;l.delay("updateFileList",f.updateFileList);l.delay("updateMenu",N)};this.isModified=function(){return h};this.length=function(){return d.length};this.clearAnnotations=function(){for(var e=0;e<d.length;e++){d[e].clearAnnotations()}};this.getFile=function(e){return d[e]};this.getFiles=function(){return d};this.getDirectoryStructure=function(){var t={isDir:!0,content:{}};function e(e){var i=d[e],l=i.getFileName(),n=l.split("/"),a=t;for(var o in n){if(n.hasOwnProperty(o)){var s=n[o];if(o==n.length-1){a.content[s]={isDir:!1,content:i,pos:e}}else{if(!a.content[s]){a.content[s]={isDir:!0,content:{}}}a=a.content[s]}}}}for(var l in d){if(d.hasOwnProperty(l)){e(l)}}return t};this.generateFileList=function(){if(!f.isFileListVisible()){return}function e(i,t,n){for(var a in i.content){if(i.content.hasOwnProperty(a)){var o=i.content[a];if(o.isDir){n.push(t+l.iconFolder()+l.sanitizeText(a));e(o,t+"<span class=\"vpl_ide_dirindent\"></span>",n)}else{var d=o.content,s=l.sanitizeText(a),r=l.sanitizeText(d.getFileName());if(d.isOpen()){s="<b>"+s+"</b>"}var c="href=\"#\" data-fileid=\""+d.getId()+"\" title=\""+r+"\"",p="<a "+c+">"+s+"</a>";if(d.isModified()){p=l.iconModified()+p}if(o.pos<H){p=p+l.iconRequired()}n.push(t+p)}}}}var t=f.getDirectoryStructure(),n=[],a="";e(t,"",n);for(var o=0;o<n.length;o++){a+=n[o]+"<br>"}Y.html("<div>"+a+"</div>")};a.on("click","span.vpl_ide_closeicon",function(){V.close(V.currentFile())});a.on("dblclick","span.vpl_ide_closeicon",U.getAction("delete"));a.on("dblclick","a",U.getAction("rename"));Y.on("dblclick","a",U.getAction("rename"))}this.updateEvaluationNumber=function(e){if("undefined"!=typeof e.nevaluations){var i=e.nevaluations;if("undefined"!=typeof e.reductionbyevaluation&&""<e.reductionbyevaluation&&0!=e.reductionbyevaluation){if(0!=e.freeevaluations){i=i+"/"+e.freeevaluations}i=i+" -"+e.reductionbyevaluation}U.setExtracontent("evaluate",i)}};this.lastResult=null;this.getTerminal=function(){return Fe};this.setResultGrade=function(e,i){var t="vpl_ide_accordion_t_grade",l="vpl_ide_accordion_c_grade";if(0==$.find("."+l).length){$.append("<div class=\""+t+"\"></div>");$.append("<div class=\""+l+"\"></div>")}if("undefined"==typeof i){return 0<$.find("h4."+t).length}var n=$.find("."+t);if(""<e){n.replaceWith("<h4 class=\""+t+"\">"+e+"</h4>");return!0}else{n.replaceWith("<div class=\""+t+"\"></div>");return!1}};this.setResultTab=function(e,i,l){var n="vpl_ide_accordion_t_"+e,a="vpl_ide_accordion_c_"+e;if(0==$.find("."+a).length){$.append("<div class=\""+n+"\"></div>");$.append("<div class=\""+a+"\"></div>")}if("undefined"==typeof l){return 0<$.find("h4."+n).length}var o=$.find("."+n),d=$.find("."+a),s=t("<div>"+i+"</div>");s.find("h4").replaceWith(function(){return t("<h5>").append(t(this).contents())});if(d.html()==s.html()){return""<i}if(""<i){o.replaceWith("<h4 class=\""+n+"\">"+D(e)+"</h4>");d.replaceWith("<div class=\"ui-widget "+a+"\">"+s.html()+"</div>");return!0}else{o.replaceWith("<div class=\""+n+"\"></div>");d.replaceWith("<div class=\""+a+"\"></div>");return!1}};this.setResult=function(e,t){C.updateEvaluationNumber(e);var n=V.getFiles(),a=[],o;for(o=0;o<n.length;o++){a[o]=n[o].getFileName();n[o].clearAnnotations()}var d=!1,s,r=l.sanitizeText(e.grade),c,p;c=C.setResultGrade(r,e.grade);d=d||c;s=C.setResultTab("variables",e.variables,e.variables);d=d||s;p=l.processResult(e.compilation,a,n,!0,!1);s=C.setResultTab("compilation",p,e.compilation);d=d||s;p=l.processResult(e.evaluation,a,n,!1,!1);s=C.setResultTab("comments",p,e.evaluation);d=d||s;p=l.sanitizeText(e.execution);s=C.setResultTab("execution",p,e.execution);d=d||s;s=C.setResultTab("description",window.VPLDescription,window.VPLDescription);if(s&&"object"==("undefined"==typeof MathJax?"undefined":_typeof(MathJax))){var u=$.find(".vpl_ide_accordion_c_description")[0];MathJax.Hub.Queue(["Typeset",MathJax.Hub,u])}d=d||s;if(d){Z.show();Z.vplVisible=!0;$.accordion("refresh");$.accordion("option","active",c?1:0);for(o=0;o<n.length;o++){for(var g=n[o].getAnnotations(),m=0;m<g.length;m++){if(t||"error"==g[m].type){V.gotoFile(o,g[m].row+1);break}}}}else{Z.hide();Z.vplVisible=!1}l.delay("autoResizeTab",S)};$.accordion({heightStyle:"fill",header:"h4",animate:!1,beforeActivate:m});Z.width(2*Z.vplMinWidth);$.on("click","a",function(e){if(V.gotoFileLink(e.currentTarget)){e.preventDefault()}});Z.vplVisible=!1;Z.hide();r.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all");X.text(D("filelist"));X.html(l.iconFolder()+X.html());X.addClass("ui-widget-header ui-button-text-only ui-corner-all");Y.addClass("ui-widget ui-corner-all");r.width(2*r.vplMinWidth);r.on("click","a",function(e){e.preventDefault();V.gotoFileLink(e.currentTarget)});r.vplVisible=!1;r.hide();var ee=!1;function f(){if(!1===ee){ee=(J.outerWidth(!0)-J.width())/2}return ee}function v(i,e){var t=e.position.left-e.originalPosition.left,l;if(0!=t){l=J.width()+r.width()-r.vplMinWidth;J.resizable("option","maxWidth",l);r.width(r.vplOriginalWidth+t)}else{l=J.width()+Z.width()-Z.vplMinWidth;J.resizable("option","maxWidth",l);var n=e.size.width-e.originalSize.width;Z.width(Z.vplOriginalWidth-n)}V.currentFile("adjustSize")}var ie={containment:"parent",resize:v,start:function start(){t(window).off("resize",S);J.resizable("option","minWidth",100);if(Z.vplVisible){Z.vplOriginalWidth=Z.width()}if(r.vplVisible){r.vplOriginalWidth=r.width()}},stop:function stop(i,e){v(i,e);J.resizable("option","maxWidth",1e5);J.resizable("option","minWidth",0);S();t(window).on("resize",S)},handles:""};J.resizable(ie);function _(){var e=0;e+=r.vplVisible?1:0;e+=Z.vplVisible?2:0;J.resizable("destroy");ie.handles=["e","w","e","e, w"][e];ie.disable=0===e;J.resizable(ie)}function b(){var e=t(window).outerHeight();e-=K.offset().top+K.height()+(R?f():20);if(150>e){e=150}G.height(e);var i=e-3*f();J.height(i);if(Z.vplVisible){Z.height(i+f());$.accordion("refresh")}if(r.vplVisible){Y.height(i-(X.outerHeight()+f()));r.height(i)}}k=function(e){var i=J.width(),l=0;Q.width(1e5);var n=Q.children("li:visible").last();if(n.length){var a=Q.parent().scrollLeft();l=a+n.position().left+n.width()+ee;Q.width(l);var o=V.currentFile();if(o&&e){var d=t(o.getTabNameId()),s=a+d.position().left;s-=(i-d.outerWidth())/2;if(0>s){s=0}Q.parent().finish().animate({scrollLeft:s},"slow")}}if(l<i){Q.width("")}};S=function(){var e=J.width(),i=K.width(),t=!1;_();G.width(K.outerWidth());if(r.vplVisible){var l=r.outerWidth()+ee;e+=l;if(100<=l){i-=l;J.css("left",l)}else{t=!0}}else{J.css("left",0)}if(Z.vplVisible){var n=Z.outerWidth()+ee;e+=n;i-=n;if(100>i){t=!0}}if(t){var a=K.width()/e,o=0;if(r.vplVisible){o=r.width()*a;r.width(o-ee);o+=ee;J.css("left",o)}J.width(J.width()*a);if(Z.vplVisible){Z.width(K.width()-(o+J.width()+ee))}}else{J.width(i)}k(!0);b();V.currentFile("adjustSize")};function F(){V.currentFile("focus")}var te=t.extend({},{close:F},l.dialogbaseOptions);function T(e,i){return l.showMessage(e,t.extend({},te,i))}I=function(e){return l.showErrorMessage(e,{close:F})};var le=t("#vpl_ide_dialog_new");function w(e){if(!("click"==e.type||"keypress"==e.type&&13==e.keyCode)){return!0}le.dialog("close");var i={name:t("#vpl_ide_input_newfilename").val(),contents:"",encoding:0},l=V.addFile(i,!1,N,I);if(l){V.open(l);J.tabs("option","active",V.getTabPos(l));l.focus();return!0}return!1}var ne={};ne[D("ok")]=w;ne[D("cancel")]=function(){t(this).dialog("close")};le.find("input").on("keypress",w);le.dialog(t.extend({},te,{title:D("create_new_file"),buttons:ne}));l.setDialogTitleIcon(le,"new");var ae=t("#vpl_ide_dialog_rename");function y(e){if(!("click"==e.type||"keypress"==e.type&&13==e.keyCode)){return}ae.dialog("close");V.renameFile(V.currentFile("getFileName"),t("#vpl_ide_input_renamefilename").val(),I);e.preventDefault()}ae.find("input").on("keypress",y);ne[D("ok")]=y;ae.dialog(t.extend({},te,{open:function open(){t("#vpl_ide_input_renamefilename").val(V.currentFile("getFileName"))},title:D("rename_file"),buttons:ne}));l.setDialogTitleIcon(ae,"rename");ne[D("ok")]=function(){t(this).dialog("close")};var oe=t("#vpl_ide_dialog_comments");oe.dialog(t.extend({},te,{title:D("comments"),width:"40em",buttons:ne}));l.setDialogTitleIcon(oe,"comments");t("#vpl_ide_input_comments").width("30em");var de=t("#vpl_ide_dialog_about"),se={};se[D("ok")]=function(){t(this).dialog("close")};var re=t("#vpl_ide_dialog_shortcuts");re.dialog(t.extend({},te,{open:function open(){var e=U.getShortcuts(V.currentFile("getEditor"));t("#vpl_ide_dialog_shortcuts").html(e)},title:D("shortcuts"),width:400,height:300,buttons:se}));re.dialog("option","height",300);l.setDialogTitleIcon(re,"shortcuts");se[D("shortcuts")]=function(){t(this).dialog("close");re.dialog("open")};de.dialog(t.extend({},te,{open:function open(){var e=U.getShortcuts(V.currentFile("getEditor"));de.next().find("button").filter(function(){return t(this).text()==D("shortcuts")}).button(""!=e?"enable":"disable")},title:D("about"),width:400,height:300,buttons:se}));de.dialog("option","height",300);l.setDialogTitleIcon(de,"about");var ce=t("#vpl_ide_dialog_sort"),pe={};pe[D("ok")]=function(){var e=V.getFiles(),l=[],n=0,a=t("#vpl_sort_list li");if(a.length!=e.length){return}a.each(function(){var i=parseInt(this.id.replace(/[^\d]*/,""));l.push(e[i])});for(n=0;n<a.length;n++){e[n]=l[n]}V.setModified();t(this).dialog("close")};pe[D("cancel")]=function(){t(this).dialog("close")};ce.dialog(t.extend({},te,{title:D("sort"),buttons:pe,open:function open(){var e=t("#vpl_sort_list");e.html("");for(var l=V.getFiles(),n=0,a;n<l.length;n++){a=t("<li id=\"vpl_fsort_"+n+"\"class=\"ui-widget-content\"></li>");if(n<H){a.addClass("ui-state-disabled")}a.text(n+1+"-"+l[n].getFileName());e.append(a)}e.sortable({items:"li:not(.ui-state-disabled)",placeholder:"ui-state-highlight",start:function start(e,i){i.item.addClass("ui-state-highlight")},stop:function stop(e,i){i.item.removeClass("ui-state-highlight")}});e.disableSelection()},maxHeight:400}));l.setDialogTitleIcon(ce,"sort");var ue=t("#vpl_ide_dialog_multidelete"),ge={};ge[D("selectall")]=function(){t(this).find("input").prop("checked",!0)};ge[D("deselectall")]=function(){t(this).find("input").prop("checked",!1)};ge[D("deleteselected")]=function(){var e=V.getFiles(),n=[],a=t("#vpl_multidelete_list label");a.each(function(){var i=t(this);if(i.find("input").prop("checked")){var l=i.data("fileid");n.push(e[l].getFileName())}});for(var o=0;o<n.length;o++){V.deleteFile(n[o],!1,I)}l.delay("updateMenu",N);l.delay("updateFileList",V.updateFileList);t(this).dialog("close")};ge[D("cancel")]=function(){t(this).dialog("close")};ue.dialog(t.extend({},te,{title:D("multidelete"),buttons:ge,open:function open(){var e=t("#vpl_multidelete_list");e.html("");for(var n=V.getFiles(),a=H;a<n.length;a++){var o=l.sanitizeText(n[a].getFileName()),d=t("<label><input type=\"checkbox\"> "+o+"</label>");d.data("fileid",a);e.append(d);e.append("<br>")}e.find("label").button()},maxHeight:400,maxWidth:400}));l.setDialogTitleIcon(ue,"multidelete");var me=t("#vpl_ide_dialog_fontsize"),he=t("#vpl_ide_dialog_fontsize .vpl_fontsize_slider"),fe={};fe[D("ok")]=function(){var e=he.slider("value");V.setFontSize(e);t(this).dialog("close");t.ajax({async:!0,type:"POST",url:"../editor/userpreferences.json.php",data:JSON.stringify({fontSize:e}),contentType:"application/json; charset=utf-8",dataType:"json"})};fe[D("cancel")]=function(){V.setFontSize(he.data("vpl_fontsize"));t(this).dialog("close")};fe[D("reset")]=function(){he.slider("value",12)};me.dialog(t.extend({},te,{title:D("fontsize"),buttons:fe,open:function open(){he.data("vpl_fontsize",V.getFontSize());he.slider("value",V.getFontSize())}}));he.slider({min:1,max:48,change:function change(){var e=he.slider("value");V.setFontSize(e);me.find(".vpl_fontsize_slider_value").text(e)}});l.setDialogTitleIcon(me,"fontsize");var ve=t("#vpl_ide_dialog_acetheme"),_e=t("#vpl_ide_dialog_acetheme select"),be={};be[D("ok")]=function(){V.setTheme(_e.val());t(this).dialog("close");l.setUserPreferences({aceTheme:_e.val()})};be[D("cancel")]=function(){V.setTheme(_e.data("acetheme"));t(this).dialog("close")};be[D("reset")]=function(){_e.val(_e.data("acetheme"));V.setTheme(_e.val())};ve.dialog(t.extend({},te,{title:D("theme"),buttons:be,modal:!1,open:function open(){_e.data("acetheme",V.getTheme());_e.val(V.getTheme())}}));_e.on("change",function(){V.setTheme(_e.val())});l.setDialogTitleIcon(ve,"theme");var Fe=new o("vpl_dialog_terminal","vpl_terminal",D),Te=new d("vpl_dialog_vnc",D),we=Fe,ye=t("#vpl_ide_input_file");ye.on("change",function fileSelectHandler(){l.readSelectedFiles(this.files,function(e){return V.addFile(e,!0,N,I)},function(){V.fileListVisibleIfNeeded()})});U.add({name:"filelist",originalAction:function originalAction(){V.fileListVisible(!V.isFileListVisible());l.delay("updateMenu",N);l.delay("autoResizeTab",S);l.delay("updateFileList",V.updateFileList)},bindKey:{win:"Ctrl-L",mac:"Ctrl-L"}});U.add({name:"new",originalAction:function originalAction(){if(V.length()<W){le.dialog("open")}},bindKey:{win:"Alt-N",mac:"Option-N"}});U.add({name:"rename",originalAction:function originalAction(){var e=V.currentFile();if(e&&V.getFilePosById(e.getId())>=H){ae.dialog("open")}},bindKey:{win:"Ctrl-R",mac:"Ctrl-R"}});U.add({name:"delete",originalAction:function originalAction(){var e=V.currentFile();if(!e){return}var i=e.getFileName(),t=D("delete_file_fq",i);T(t,{ok:function ok(){V.deleteFile(i,I)},title:D("delete_file_q"),icon:"trash"})},bindKey:{win:"Ctrl-D",mac:"Ctrl-D"}});U.add({name:"close",originalAction:function originalAction(){var e=V.currentFile();if(!e){return}V.close(e)},bindKey:{win:"Alt-W",mac:"Option-W"}});U.add({name:"import",originalAction:function originalAction(){ye.val("");ye.trigger("click")},bindKey:{win:"Ctrl-I",mac:"Ctrl-I"}});U.add({name:"sort",originalAction:function originalAction(){ce.dialog("open")},bindKey:{win:"Ctrl-O",mac:"Ctrl-O"}});U.add({name:"multidelete",originalAction:function originalAction(){ue.dialog("open")}});U.add({name:"fontsize",originalAction:function originalAction(){me.dialog("open")}});U.add({name:"theme",originalAction:function originalAction(){ve.dialog("open")}});U.add({name:"print",originalAction:function originalAction(){window.print()},bindKey:{win:"Alt-P",mac:"Command-P"}});U.add({name:"undo",originalAction:function originalAction(){V.currentFile("undo")}});U.add({name:"redo",originalAction:function originalAction(){V.currentFile("redo")}});U.add({name:"select_all",editorName:"selectall",originalAction:function originalAction(){V.currentFile("selectAll")}});U.add({name:"find",originalAction:function originalAction(){V.currentFile("find")}});U.add({name:"find_replace",editorName:"replace",originalAction:function originalAction(){V.currentFile("replace")}});U.add({name:"next",editorName:"findnext",originalAction:function originalAction(){V.currentFile("next")}});U.add({name:"fullscreen",originalAction:function originalAction(){var e="header, nav, footer, aside, .dropdown, #page-header, div.navbar, #nav-drawer";e+=", div.tabtree, #dock, .breadcrumb-nav, .moodle-actionmenu";if(R){j.removeClass("vpl_ide_root_fullscreen");t("body").removeClass("vpl_body_fullscreen");U.setText("fullscreen","fullscreen");t(e).show();t("#vpl_ide_user").hide();R=!1}else{t("body").addClass("vpl_body_fullscreen").scrollTop(0);t(e).hide();j.addClass("vpl_ide_root_fullscreen");U.setText("fullscreen","regularscreen");if(c.username){t("#vpl_ide_user").show()}R=!0}F();setTimeout(S,10)},bindKey:{win:"Alt-F",mac:"Ctrl-F"}});U.add({name:"download",originalAction:function originalAction(){window.location=c.download}});function x(){l.requestAction("resetfiles","",{},c.ajaxurl).done(function(e){var i=e.files;for(var t in i){if(i.hasOwnProperty(t)){V.addFile(i[t],!0,l.doNothing,I)}}V.fileListVisibleIfNeeded();l.delay("updateMenu",N)}).fail(I)}U.add({name:"resetfiles",originalAction:function originalAction(){T(D("sureresetfiles"),{title:D("resetfiles"),ok:x,icon:"resetfiles"})}});U.add({name:"save",originalAction:function originalAction(){var i={files:V.getFilesToSave(),comments:t("#vpl_ide_input_comments").val(),version:V.getVersion()};if(JSON.stringify(i).length>c.postMaxSize){I(D("maxpostsizeexceeded"));return}function e(){l.requestAction("save","saving",i,c.ajaxurl).done(function(t){if(t.requestsconfirmation){T(t.question,{title:D("saving"),icon:"alert",yes:function yes(){i.version=t.version;e()}})}else{V.resetModified();V.setVersion(t.version);U.setTimeLeft(t);l.delay("updateMenu",N)}z()}).fail(I)}e()},bindKey:{win:"Ctrl-S",mac:"Command-S"}});var xe={getConsole:function getConsole(){return we},setResult:C.setResult,ajaxurl:c.ajaxurl,run:function run(e,i,t){if(we&&we.isOpen()){we.close()}if("terminal"==e){we=Fe;Fe.connect(i.executionURL,function(){t.close();F()})}else{we=Te;Te.connect(i.secure,i.server,i.portToUse,i.VNCpassword,i.executionPath,function(){t.close();F()})}},lastAction:!1,getLastAction:function getLastAction(){var e=this.lastAction;this.lastAction=!1;return e},setLastAction:function setLastAction(e){this.lastAction=e}};function L(e,i,t){if(!t){t={}}if(!we.isConnected()){l.requestAction(e,"",t,c.ajaxurl).done(function(t){l.webSocketMonitor(t,e,i,xe)}).fail(I)}}function M(){L("run","running",{XGEOMETRY:Te.getCanvasSize()})}U.add({name:"run",originalAction:function originalAction(){xe.setLastAction(M);M()},bindKey:{win:"Ctrl-F11",mac:"Command-U"}});function A(){L("debug","debugging",{XGEOMETRY:Te.getCanvasSize()})}U.add({name:"debug",originalAction:function originalAction(){xe.setLastAction(A);A()},bindKey:{win:"Alt-F11",mac:"Option-U"}});function z(){L("evaluate","evaluating")}U.add({name:"evaluate",originalAction:function originalAction(){xe.setLastAction(z);z()},bindKey:{win:"Shift-F11",mac:"Command-Option-U"}});U.add({name:"comments",originalAction:function originalAction(){oe.dialog("open")}});U.add({name:"console",originalAction:function originalAction(){if(we.isOpen()){we.close()}else{we.show()}}});U.add({name:"user"});U.add({name:"about",originalAction:function originalAction(){de.dialog("open")}});U.add({name:"timeleft",originalAction:function originalAction(){U.toggleTimeLeft()}});U.add({name:"more",originalAction:function originalAction(){var e=t("#vpl_ide_menuextra");if(e.is(":visible")){U.setText("more","more",l.str("more"));e.hide()}else{U.setText("more","less",l.str("less"));e.show()}l.delay("updateMenu",N);l.delay("autoResizeTab",S)}});K.addClass("ui-widget-header ui-corner-all");var Le="";Le+=U.getHTML("more");Le+=U.getHTML("save");Le+="<span id='vpl_ide_mexecution'>";Le+=U.getHTML("run");Le+=U.getHTML("debug");Le+=U.getHTML("evaluate");Le+=U.getHTML("comments");Le+=U.getHTML("console");Le+="</span> ";Le+="<span id='vpl_ide_menuextra'>";Le+="<span id='vpl_ide_file'>";Le+=U.getHTML("filelist");Le+=U.getHTML("new");Le+=U.getHTML("rename");Le+=U.getHTML("delete");Le+=U.getHTML("import");Le+=U.getHTML("download");Le+=U.getHTML("resetfiles");Le+=U.getHTML("sort");Le+=U.getHTML("multidelete");Le+=U.getHTML("fontsize");Le+=U.getHTML("theme");Le+="</span> ";Le+="<span id='vpl_ide_edit'>";Le+=U.getHTML("undo");Le+=U.getHTML("redo");Le+=U.getHTML("select_all");Le+=U.getHTML("find");Le+=U.getHTML("find_replace");Le+=U.getHTML("next");Le+="</span> ";Le+="</span> ";Le+=U.getHTML("fullscreen")+" ";Le+=U.getHTML("about")+" ";Le+=U.getHTML("user")+" ";Le+=U.getHTML("timeleft");Le+="<div class=\"clearfix\"></div>";K.append(Le);t("#vpl_ide_more").button();t("#vpl_ide_save").button();t("#vpl_ide_menuextra").hide();t("#vpl_ide_file").controlgroup();t("#vpl_ide_edit").controlgroup();t("#vpl_ide_mexecution").controlgroup();t("#vpl_ide_fullscreen").button();t("#vpl_ide_acetheme").button();t("#vpl_ide_about").button();t("#vpl_ide_user").button().css("float","right").hide();t("#vpl_ide_timeleft").button().css("float","right").hide();t("#vpl_menu .ui-button").css("padding","6px");t("#vpl_menu .ui-button-text").css("padding","0");for(var Me=["filelist","more","fullscreen","about","resetfiles","download","comments","console","import","fontsize","timeleft"],Ae=0;Ae<Me.length;Ae++){U.enable(Me[Ae],!0)}U.setExtracontent("user",c.username);U.setTimeLeft(c);N=function(){var e,t=V.currentFile(),n=V.length();if(n){J.show()}else{J.hide()}if(V.isFileListVisible()){U.setText("filelist","filelistclose",l.str("filelist"))}else{U.setText("filelist","filelist",l.str("filelist"))}var a=V.isModified();U.enable("save",a);U.enable("run",(!a||c.example)&&q("run"));U.enable("debug",(!a||c.example)&&q("debug"));U.enable("evaluate",(!a||c.example)&&q("evaluate"));U.enable("download",!a);U.enable("new",n<W);U.enable("sort",1<n-H);U.enable("multidelete",1<n-H);U.enable("theme",!0);var o;if(!t||0===n){o=["rename","delete","undo","redo","select_all","find","find_replace","next"];for(e=0;e<o.length;e++){U.enable(o[e],!1)}return}var d=V.getFilePosById(t.getId());U.enable("rename",d>=H&&0!==n);U.enable("delete",d>=H&&0!==n);U.enable("undo",t.hasUndo());U.enable("redo",t.hasRedo());U.enable("select_all",t.hasSelectAll());U.enable("find",t.hasFind());U.enable("find_replace",t.hasFindReplace());U.enable("next",t.hasNext());l.delay("updateFileList",V.updateFileList)};J.on("tabsactivate",function(){V.currentFile("focus");l.delay("updateMenu",N);l.delay("autoResizeTab",S)});var ze=t(window);ze.on("resize",S);if(!c.example){ze.on("beforeunload",function(){if(V.isModified()){return D("changesNotSaved")}})}V=new h;S();(function(){var i=K.width();function e(){var e=K.width();if(i!=e){i=e;S()}}e();setInterval(e,1e3)})();V.resetModified();l.requestAction("load","loading",c,c.loadajaxurl).done(function(e){for(var n=!0,a=e.files,o=!1,d=0;d<a.length;d++){var s=a[d],p=V.addFile(s,!1,N,I);if(p){p.resetModified();if(d<H||5>=a.length){V.open(p)}else{o=!0}}else{n=!1}}J.tabs("option","active",0);if(e.compilationexecution){C.setResult(e.compilationexecution,!1)}U.setTimeLeft(e);if(""<e.comments){t("#vpl_ide_input_comments").val(e.comments)}if(n){V.resetModified()}else{V.setModified()}if(0===V.length()&&0<W){U.getAction("new")()}else if(!c.saved){V.setModified()}V.setFontSize(c.fontSize);V.setVersion(e.version);V.fileListVisible(o);l.afterAll("AfterLoadFiles",function(){N();S();k(!0)})}).fail(I)};window.VPLIDE=r;return{init:function init(e,i){s=new r(e,i)}}});
//# sourceMappingURL=vplide.min.js.map
